# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤ production (ISPmanager)

## ‚úÖ –°—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ production

### –ë—ç–∫–µ–Ω–¥ (Express + MongoDB Atlas)
- ‚úÖ MongoDB Atlas –ø–æ–¥–∫–ª—é—á–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã (3/3: addUser, addCategories, addProducts)
- ‚úÖ Production —Å–µ–∫—Ä–µ—Ç—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã (JWT, SESSION)
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è –¥–æ–º–µ–Ω–∞ artyom-dev.ru
- ‚úÖ Health check endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç (`/health`)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ (Winston + Morgan)
- ‚úÖ Security middleware (Helmet, Rate Limiting)
- ‚úÖ Compression –≤–∫–ª—é—á–µ–Ω
- ‚ö†Ô∏è MemoryStore –¥–ª—è —Å–µ—Å—Å–∏–π (–¥–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è Redis/MongoDB store)

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ (Angular)
- ‚úÖ Production —Å–±–æ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
- ‚úÖ API –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ https://artyom-dev.ru
- ‚úÖ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –≥–æ—Ç–æ–≤—ã –≤ `dist/store_for_angular/`
- ‚ö†Ô∏è 10 –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –±—é–¥–∂–µ—Ç–∞ CSS (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ)

---

## üì¶ –®–∞–≥ 1: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –±—ç–∫–µ–Ω–¥–∞

### 1.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
1. –í–æ–π–¥–∏—Ç–µ –≤ **ISPmanager**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω **Node.js 16+** (–°–µ—Ä–≤–µ—Ä > –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ MongoDB Atlas –¥–æ—Å—Ç—É–ø–µ–Ω —Å IP —Å–µ—Ä–≤–µ—Ä–∞:
   - –û—Ç–∫—Ä–æ–π—Ç–µ [MongoDB Atlas](https://cloud.mongodb.com/)
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Network Access**
   - –î–æ–±–∞–≤—å—Ç–µ IP —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ `0.0.0.0/0` (–≤—Ä–µ–º–µ–Ω–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞)

### 1.2 –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
1. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–¥–¥–æ–º–µ–Ω –≤ ISPmanager: `api.artyom-dev.ru`
   - WWW > WWW-–¥–æ–º–µ–Ω—ã > –î–æ–±–∞–≤–∏—Ç—å –¥–æ–º–µ–Ω
   - –¢–∏–ø: **Node.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
   - –ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞: `/www/api.artyom-dev.ru`
   - –ü–æ—Ä—Ç: `3000`

2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø–∞–ø–∫—É `store_backend/` –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ FTP –∏–ª–∏ —Ñ–∞–π–ª–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä:
   ```
   –õ–æ–∫–∞–ª—å–Ω–æ: c:\Users\User\Desktop\–∏–Ω—Ç–µ—Ä–Ω–µ—Ç_–º–∞–≥–∞–∑–∏–Ω\store_backend\
   –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ: /www/api.artyom-dev.ru/
   ```

3. **–í–∞–∂–Ω–æ**: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env` —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏:
   ```bash
   # –§–∞–π–ª .env –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
   NODE_ENV=production
   PORT=3000
   JWT_SECRET=7wMEr0ITGDWip5CufOgJjRs81kqXYPZLn6SeAUVBmcNa9v4KzbhQxHdtyFo3l2
   SESSION_SECRET=u7vSY1gZnwKMQieb6zG5RAtJ4sEjCkF98lIm2rhDcpPHdaU3xLy0qfBWXoTONV
   MONGO_URI=mongodb+srv://artem2006pax_db_user:hbJJ7Z38zRTJBTku@cluster0.miv1xt2.mongodb.net/im?retryWrites=true&w=majority
   DB_NAME=im
   CORS_ORIGIN=https://artyom-dev.ru
   ```

### 1.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
–ß–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª ISPmanager (–∏–ª–∏ SSH):

```bash
cd /www/api.artyom-dev.ru
npm install
npm run prod  # –ó–∞–ø—É—Å–∫ —Å PM2
```

–ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤ ISPmanager:
- –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞: `npm start`
- –ü–æ—Ä—Ç: `3000`
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å

### 1.4 –ü—Ä–æ–≤–µ—Ä–∫–∞
```bash
curl http://localhost:3000/health
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: {"status":"OK","timestamp":"..."}
```

---

## üåê –®–∞–≥ 2: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### 2.1 –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ ISPmanager > WWW > WWW-–¥–æ–º–µ–Ω—ã
2. –í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–º–µ–Ω **artyom-dev.ru**
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–∞–ø–∫–∏ `dist/store_for_angular/` –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É —Å–∞–π—Ç–∞:
   ```
   –õ–æ–∫–∞–ª—å–Ω–æ: c:\Users\User\Desktop\–∏–Ω—Ç–µ—Ä–Ω–µ—Ç_–º–∞–≥–∞–∑–∏–Ω\store_for_angular\dist\store_for_angular\
   –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ: /www/artyom-dev.ru/
   ```

### 2.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .htaccess (–µ—Å–ª–∏ Apache)
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/www/artyom-dev.ru/.htaccess`:

```apache
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^index\.html$ - [L]
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /index.html [L]
</IfModule>
```

---

## üîó –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏ –¥–ª—è API

–ß—Ç–æ–±—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ–±—Ä–∞—â–∞–ª—Å—è –∫ `https://artyom-dev.ru/api`, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ–∫—Å–∏ –≤ ISPmanager.

### 3.1 –î–ª—è Nginx
–í ISPmanager > WWW > –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–º–µ–Ω–∞ `artyom-dev.ru` > –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx:

```nginx
location /api/ {
    proxy_pass http://127.0.0.1:3000/api/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_cache_bypass $http_upgrade;
}
```

### 3.2 –î–ª—è Apache
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/www/artyom-dev.ru/.htaccess` (–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π):

```apache
<IfModule mod_proxy.c>
  ProxyPreserveHost On
  ProxyPass /api/ http://127.0.0.1:3000/api/
  ProxyPassReverse /api/ http://127.0.0.1:3000/api/
</IfModule>
```

---

## üîí –®–∞–≥ 4: SSL (HTTPS)

1. –í ISPmanager –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ WWW > WWW-–¥–æ–º–µ–Ω—ã > artyom-dev.ru
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **SSL**
3. –í—ã–±–µ—Ä–∏—Ç–µ **Let's Encrypt** –∏ —Å–æ–∑–¥–∞–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ

---

## ‚úÖ –®–∞–≥ 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### 5.1 –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–µ–Ω–¥–∞
```bash
curl https://artyom-dev.ru/api/health
# –û–∂–∏–¥–∞–µ—Ç—Å—è: {"status":"OK","timestamp":"..."}
```

### 5.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://artyom-dev.ru –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –æ—à–∏–±–∫–∏
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é/–≤—Ö–æ–¥
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≤–∞—Ä–æ–≤
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É

### 5.3 –õ–æ–≥–∏
- –ë—ç–∫–µ–Ω–¥: `/www/api.artyom-dev.ru/combined.log`, `error.log`
- ISPmanager: –†–∞–∑–¥–µ–ª **–õ–æ–≥–∏** > WWW-–¥–æ–º–µ–Ω—ã

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è production (–ø–æ—Å–ª–µ –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è):

1. **Session Store**: –ó–∞–º–µ–Ω–∏—Ç–µ MemoryStore –Ω–∞ Redis –∏–ª–∏ MongoDB:
   ```bash
   npm install connect-mongo
   ```
   –í `app.js`:
   ```javascript
   const MongoStore = require('connect-mongo');
   app.use(session({
     store: MongoStore.create({ mongoUrl: process.env.MONGO_URI }),
     // ...–æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   }));
   ```

2. **PM2 –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞**:
   ```bash
   pm2 startup
   pm2 save
   ```

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**:
   ```bash
   pm2 monit
   ```

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:
   - –£–¥–∞–ª–∏—Ç–µ `0.0.0.0/0` –∏–∑ MongoDB Atlas whitelist, –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ IP —Å–µ—Ä–≤–µ—Ä–∞
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall –¥–ª—è –ø–æ—Ä—Ç–∞ 3000 (–∑–∞–∫—Ä–æ–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π –¥–æ—Å—Ç—É–ø)
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `npm audit fix`

5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞**:
   - –£–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä CSS (—Å–º. –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏)
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

---

## üìù –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] MongoDB Atlas: IP —Å–µ—Ä–≤–µ—Ä–∞ –≤ whitelist
- [ ] `.env` —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏
- [ ] `npm install` –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] –ë—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/health`
- [ ] –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –∫–æ—Ä–µ–Ω—å –¥–æ–º–µ–Ω–∞
- [ ] –ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è `/api/*`
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –î–æ–º–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

---

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Could not connect to MongoDB Atlas"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP whitelist –≤ MongoDB Atlas
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–∞—Ä–æ–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ `.env`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª–∞—Å—Ç–µ—Ä –∑–∞–ø—É—â–µ–Ω

### –û—à–∏–±–∫–∞: API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ artyom-dev.ru/api
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏ (Nginx/Apache)
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±—ç–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω: `pm2 status`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç 3000: `netstat -tulpn | grep 3000`

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª—ã –≤ –∫–æ—Ä–Ω–µ `/www/artyom-dev.ru/`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.htaccess` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è SPA
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ CORS –æ—à–∏–±–∫–∏

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: [CyberArt2718281/angular_store](https://github.com/CyberArt2718281/angular_store)
- –í–µ—Ç–∫–∞: `features`
- –î–æ–º–µ–Ω: https://artyom-dev.ru
- API: https://artyom-dev.ru/api

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 10 –¥–µ–∫–∞–±—Ä—è 2025 –≥.
